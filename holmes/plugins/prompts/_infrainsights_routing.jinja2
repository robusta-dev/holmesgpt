# InfraInsights Instance-Based Routing Instructions

## ğŸ¯ **CRITICAL: Parameter Extraction & Tool Calling**

When the user mentions **specific instance names**, you **MUST** extract them and pass as tool parameters.

### **ğŸ” REQUIRED Parameter Extraction Patterns:**

**User says:** `"Check the health of my dock-atlantic-staging Elasticsearch cluster"`
**You MUST call:** `elasticsearch_health_check({"instance_name": "dock-atlantic-staging"})`

**User says:** `"List all indices in dock-olyortho-staging"`
**You MUST call:** `elasticsearch_list_indices({"instance_name": "dock-olyortho-staging"})`

**User says:** `"Check my production kafka cluster"`
**You MUST call:** `kafka_health_check({"instance_name": "production"})`

### **âš ï¸ NEVER Call Tools with Empty Parameters:**

âŒ **WRONG:** `elasticsearch_health_check({})`
âœ… **RIGHT:** `elasticsearch_health_check({"instance_name": "dock-atlantic-staging"})`

### **ğŸ”§ Instance Name Detection Patterns:**

Look for these patterns in user prompts:
- **Explicit names**: `dock-atlantic-staging`, `dock-olyortho-staging`, `consolidated-demo-prod`
- **Environment + service**: `staging elasticsearch`, `production kafka`
- **Possessive + service**: `my elasticsearch cluster`, `our kafka instance`
- **Specific references**: `the elasticsearch cluster`, `that kafka instance`

### **ğŸ“‹ Toolset Routing Rules:**

#### **Elasticsearch Queries:**
- **Instance-specific**: Use `infrainsights_elasticsearch_enhanced` tools
- **Tools available**: `elasticsearch_health_check`, `elasticsearch_list_indices`
- **Required parameter**: `instance_name`

#### **Kafka Queries:**
- **Instance-specific**: Use `infrainsights_kafka_enhanced` tools  
- **Tools available**: `kafka_health_check`, `kafka_list_topics`
- **Required parameter**: `instance_name`

### **ğŸš¨ Error Resolution:**

If you get these errors:
- `"instance_name parameter is required"` â†’ You forgot to extract the instance name
- `"Instance X not found"` â†’ The instance doesn't exist in InfraInsights
- `"InfraInsights client not available"` â†’ Toolset configuration issue

### **ğŸ’¡ Example Tool Calls:**

```
User: "Check the health of my dock-atlantic-staging Elasticsearch cluster"
â†’ elasticsearch_health_check({"instance_name": "dock-atlantic-staging"})

User: "List all indices in dock-olyortho-staging"
â†’ elasticsearch_list_indices({"instance_name": "dock-olyortho-staging"})

User: "Show me the health of production kafka"
â†’ kafka_health_check({"instance_name": "production"})
```

### **ğŸ¯ Decision Matrix:**

| User Query | Toolset | Tool Call | Parameters |
|------------|---------|-----------|------------|
| `"dock-atlantic-staging elasticsearch"` | InfraInsights | `elasticsearch_health_check` | `{"instance_name": "dock-atlantic-staging"}` |
| `"my elasticsearch cluster"` | InfraInsights | `elasticsearch_health_check` | `{"instance_name": "elasticsearch"}` |
| `"elasticsearch health"` (no instance) | Built-in | `prometheus_instant_query` | `{"query": "elasticsearch_cluster_health"}` |

## **Remember: ALWAYS extract instance names and pass them as parameters!** 